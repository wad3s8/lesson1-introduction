# –û—Ç—á—ë—Ç –ø–æ –î–æ–º–∞—à–Ω–µ–º—É –ó–∞–¥–∞–Ω–∏—é ‚Ññ1: –û—Å–Ω–æ–≤—ã PyTorch

**–°—Ç—É–¥–µ–Ω—Ç**: –£—Ç—Ä–æ–±–∏–Ω –í–ª–∞–¥–∏—Å–ª–∞–≤ –ê–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤–∏—á
**–°—Ä–µ–¥–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è**: Google Colab, PyTorch —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π CUDA (NVIDIA GPU)

---

## –¶–µ–ª—å –∑–∞–¥–∞–Ω–∏—è

–ó–∞–∫—Ä–µ–ø–∏—Ç—å –Ω–∞–≤—ã–∫–∏ —Ä–∞–±–æ—Ç—ã —Å –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π PyTorch: —Ç–µ–Ω–∑–æ—Ä—ã, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ü–µ–Ω–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –Ω–∞ CPU –∏ GPU.

---

## –ó–∞–¥–∞–Ω–∏–µ 1: –†–∞–±–æ—Ç–∞ —Å —Ç–µ–Ω–∑–æ—Ä–∞–º–∏ (`homework_tensors.py`)

- –°–æ–∑–¥–∞–Ω—ã —Ç–µ–Ω–∑–æ—Ä—ã —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∏ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–µ–π.
- –í—ã–ø–æ–ª–Ω–µ–Ω—ã –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–∏–µ, –ª–æ–≥–∏—á–µ—Å–∫–∏–µ –∏ –∏–Ω–¥–µ–∫—Å–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏.

---

## –ó–∞–¥–∞–Ω–∏–µ 2: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏—Ä–æ–≤–∞–Ω–∏–µ (`homework_autograd.py`)

- –í—ã—á–∏—Å–ª–µ–Ω—ã –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã –ø—Ä–æ—Å—Ç—ã—Ö –∏ —Å–æ—Å—Ç–∞–≤–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π.
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ `torch.autograd.grad` —Å–æ–≤–ø–∞–ª–∞ —Å –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–º–∏ —Ä–∞—Å—á—ë—Ç–∞–º–∏.
- –û—Å–≤–æ–µ–Ω–æ –ø—Ä–∞–≤–∏–ª–æ —Ü–µ–ø–æ—á–∫–∏ (chain rule) –∏ –º–µ—Ö–∞–Ω–∏–∑–º `.backward()`.

---

## –ó–∞–¥–∞–Ω–∏–µ 3: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ CPU –∏ CUDA (`homework_performance.py`)

–¢–µ—Å—Ç—ã –≤—ã–ø–æ–ª–Ω—è–ª–∏—Å—å –Ω–∞ Google Colab —Å GPU NVIDIA (CUDA –¥–æ—Å—Ç—É–ø–Ω–∞). –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å —Ä–∞–∑–º–µ—Ä—ã –º–∞—Ç—Ä–∏—Ü:

- 64 √ó 1024
- 128 √ó 512
- 256 √ó 256

–î–ª—è –∫–∞–∂–¥–æ–π —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ –∑–∞–º–µ—Ä—è–ª–∏—Å—å 5 –æ–ø–µ—Ä–∞—Ü–∏–π:

- –ú–∞—Ç—Ä–∏—á–Ω–æ–µ —É–º–Ω–æ–∂–µ–Ω–∏–µ
- –ü–æ—ç–ª–µ–º–µ–Ω—Ç–Ω–æ–µ —Å–ª–æ–∂–µ–Ω–∏–µ
- –ü–æ—ç–ª–µ–º–µ–Ω—Ç–Ω–æ–µ —É–º–Ω–æ–∂–µ–Ω–∏–µ
- –¢—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
- –°—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã:

| –û–ø–µ—Ä–∞—Ü–∏—è         | –†–∞–∑–º–µ—Ä  | CPU (–º—Å) | CUDA (–º—Å) | –£—Å–∫–æ—Ä–µ–Ω–∏–µ |
| ---------------- | ------- | -------- | --------- | --------- |
| –ú–∞—Ç—Ä. —É–º–Ω–æ–∂–µ–Ω–∏–µ  | 64√ó1024 | 2.47     | 187.44    | 0.01x     |
| –°–ª–æ–∂–µ–Ω–∏–µ         | 64√ó1024 | 3.60     | 38.52     | 0.09x     |
| –£–º–Ω–æ–∂–µ–Ω–∏–µ        | 64√ó1024 | 0.21     | 29.03     | 0.01x     |
| –¢—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ | 64√ó1024 | 0.08     | 3.26      | 0.02x     |
| –°—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ     | 64√ó1024 | 0.13     | 39.51     | 0.00x     |
| –ú–∞—Ç—Ä. —É–º–Ω–æ–∂–µ–Ω–∏–µ  | 128√ó512 | 15.37    | 0.22      | 69.90x    |
| –°–ª–æ–∂–µ–Ω–∏–µ         | 128√ó512 | 0.21     | 0.06      | 3.51x     |
| –£–º–Ω–æ–∂–µ–Ω–∏–µ        | 128√ó512 | 0.16     | 0.04      | 3.61x     |
| –¢—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ | 128√ó512 | 0.02     | 0.03      | 0.68x     |
| –°—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ     | 128√ó512 | 0.04     | 0.06      | 0.68x     |
| –ú–∞—Ç—Ä. —É–º–Ω–æ–∂–µ–Ω–∏–µ  | 256√ó256 | 0.74     | 0.17      | 4.35x     |
| –°–ª–æ–∂–µ–Ω–∏–µ         | 256√ó256 | 0.18     | 0.06      | 3.08x     |
| –£–º–Ω–æ–∂–µ–Ω–∏–µ        | 256√ó256 | 0.17     | 0.04      | 4.19x     |
| –¢—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ | 256√ó256 | 0.01     | 0.02      | 0.63x     |
| –°—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ     | 256√ó256 | 0.05     | 0.05      | 1.00x     |

---

## –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (3.4)

### üîπ –ö–∞–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ø–æ–ª—É—á–∞—é—Ç –Ω–∞–∏–±–æ–ª—å—à–µ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ –Ω–∞ GPU?

- **–ú–∞—Ç—Ä–∏—á–Ω–æ–µ —É–º–Ω–æ–∂–µ–Ω–∏–µ** –Ω–∞ —Å—Ä–µ–¥–Ω–∏—Ö –º–∞—Ç—Ä–∏—Ü–∞—Ö (128√ó512 –∏ 256√ó256) –¥–∞–ª–æ –ø—Ä–∏—Ä–æ—Å—Ç –¥–æ **70x** –∏ **4.3x** —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ.
- **–ü–æ—ç–ª–µ–º–µ–Ω—Ç–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏** (`add`, `mul`) –Ω–∞ —ç—Ç–∏—Ö –∂–µ –º–∞—Ç—Ä–∏—Ü–∞—Ö –¥–∞–ª–∏ –ø—Ä–∏—Ä–æ—Å—Ç **3‚Äì4x**.

### üîπ –ü–æ—á–µ–º—É –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –º–µ–¥–ª–µ–Ω–Ω–µ–µ –Ω–∞ GPU?

- **–ú–∞–ª–µ–Ω—å–∫–∏–µ –º–∞—Ç—Ä–∏—Ü—ã (64√ó1024)**: –∑–∞—Ç—Ä–∞—Ç—ã –Ω–∞ –∑–∞–ø—É—Å–∫ CUDA-—è–¥–µ—Ä –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –ø–µ—Ä–µ–∫—Ä—ã–≤–∞—é—Ç –≤—ã–≥–æ–¥—É –æ—Ç –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–∞.
- **–ü—Ä–æ—Å—Ç—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏** (–Ω–∞–ø—Ä–∏–º–µ—Ä, `sum`, `transpose`) –º–æ–≥—É—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –±—ã—Å—Ç—Ä–µ–µ –Ω–∞ CPU –∏–∑-–∑–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤ –¥–æ—Ä–æ–≥–æ—Å—Ç–æ—è—â–∏—Ö –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è—Ö –ø–∞–º—è—Ç–∏ –∏ –∑–∞–ø—É—Å–∫–µ GPU-—è–¥–µ—Ä.

### üîπ –ö–∞–∫ —Ä–∞–∑–º–µ—Ä –º–∞—Ç—Ä–∏—Ü –≤–ª–∏—è–µ—Ç –Ω–∞ —É—Å–∫–æ—Ä–µ–Ω–∏–µ?

- –£—Å–∫–æ—Ä–µ–Ω–∏–µ –Ω–∞ GPU **—É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è —Å —Ä–æ—Å—Ç–æ–º —Ä–∞–∑–º–µ—Ä–∞ —Ç–µ–Ω–∑–æ—Ä–∞**.
- –ë–æ–ª—å—à–∏–µ —Ä–∞–∑–º–µ—Ä—ã –ø–æ–∑–≤–æ–ª—è—é—Ç **—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ –∑–∞–≥—Ä—É–∑–∏—Ç—å –≤—Å–µ CUDA-–ø–æ—Ç–æ–∫–∏**, –∏ –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º GPU —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –æ–ø—Ä–∞–≤–¥–∞–Ω–Ω—ã–º.

### üîπ –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –ø–µ—Ä–µ–¥–∞—á–µ –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É CPU –∏ GPU?

- –ü—Ä–∏ –≤—ã–∑–æ–≤–µ `.to("cuda")` –¥–∞–Ω–Ω—ã–µ –∫–æ–ø–∏—Ä—É—é—Ç—Å—è –∏–∑ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏ (RAM) –≤ –≤–∏–¥–µ–æ–ø–∞–º—è—Ç—å (VRAM).
- –≠—Ç–∞ –æ–ø–µ—Ä–∞—Ü–∏—è **–¥–æ—Ä–æ–≥–∞—è –ø–æ –≤—Ä–µ–º–µ–Ω–∏**, –æ—Å–æ–±–µ–Ω–Ω–æ –ø—Ä–∏ —á–∞—Å—Ç—ã—Ö –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è—Ö.

---

## –í—ã–≤–æ–¥

- GPU —É—Å–∫–æ—Ä—è–µ—Ç —Å–ª–æ–∂–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –Ω–∞ **—Å—Ä–µ–¥–Ω–∏—Ö –∏ –±–æ–ª—å—à–∏—Ö –º–∞—Ç—Ä–∏—Ü–∞—Ö**, –æ—Å–æ–±–µ–Ω–Ω–æ –º–∞—Ç—Ä–∏—á–Ω–æ–µ —É–º–Ω–æ–∂–µ–Ω–∏–µ.
- –î–ª—è **–ø—Ä–æ—Å—Ç—ã—Ö –∏–ª–∏ –º–∞–ª—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π** CPU –º–æ–∂–µ—Ç –±—ã—Ç—å –±—ã—Å—Ç—Ä–µ–µ –∏–∑-–∑–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –Ω–∞–∫–ª–∞–¥–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤.
- **–ü–µ—Ä–µ–¥–∞—á–∞ –º–µ–∂–¥—É CPU –∏ GPU** ‚Äî —É–∑–∫–æ–µ –º–µ—Å—Ç–æ, –∫–æ—Ç–æ—Ä–æ–µ —Å–ª–µ–¥—É–µ—Ç –º–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å.
- –í —Ü–µ–ª–æ–º, –∫–æ–¥ –∞–¥–∞–ø—Ç–∏–≤–µ–Ω –∏ –º–æ–∂–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è –∫–∞–∫ —Å CUDA, —Ç–∞–∫ –∏ –±–µ–∑ –Ω–µ—ë.
